// Connexion professeur
function login() {
  const pwd = document.getElementById("password").value;
  if (pwd === "prof123") {
    document.getElementById("adminSection").style.display = "block";
    renderList(); // Afficher la liste des donn√©es existantes
    alert("Connexion r√©ussie !");
  } else {
    alert("Mot de passe incorrect !");
  }
}

// Enregistrer ou modifier une donn√©e
function saveData() {
  const date = document.getElementById("adminDate").value;
  const seance = document.getElementById("adminSeance").value;
  const devoirs = document.getElementById("adminDevoirs").value;

  if (!date) {
    alert("Veuillez choisir une date.");
    return;
  }

  let donnees = JSON.parse(localStorage.getItem("donnees")) || {};
  donnees[date] = { seance, devoirs };
  localStorage.setItem("donnees", JSON.stringify(donnees));

  alert("Donn√©es enregistr√©es !");
  renderList();
}

// Supprimer une donn√©e
function deleteData(date) {
  let donnees = JSON.parse(localStorage.getItem("donnees")) || {};
  if (donnees[date]) {
    if (confirm(`Supprimer l'entr√©e du ${date} ?`)) {
      delete donnees[date];
      localStorage.setItem("donnees", JSON.stringify(donnees));
      renderList();
    }
  }
}

// Charger une donn√©e pour modification
function editData(date) {
  let donnees = JSON.parse(localStorage.getItem("donnees")) || {};
  if (donnees[date]) {
    document.getElementById("adminDate").value = date;
    document.getElementById("adminSeance").value = donnees[date].seance;
    document.getElementById("adminDevoirs").value = donnees[date].devoirs;
  }
}

// Afficher la liste c√¥t√© professeur
function renderList() {
  let donnees = JSON.parse(localStorage.getItem("donnees")) || {};
  let listDiv = document.getElementById("dataList");

  if (!listDiv) {
    listDiv = document.createElement("div");
    listDiv.id = "dataList";
    document.getElementById("adminSection").appendChild(listDiv);
  }

  listDiv.innerHTML = "<h3>üìã Liste des entr√©es</h3>";

  const dates = Object.keys(donnees).sort();
  if (dates.length === 0) {
    listDiv.innerHTML += "<p>Aucune donn√©e enregistr√©e.</p>";
    return;
  }

  dates.forEach(date => {
    const entry = donnees[date];
    const item = document.createElement("div");
    item.style.border = "1px solid #ccc";
    item.style.padding = "5px";
    item.style.margin = "5px 0";

    item.innerHTML = `
      <strong>${date}</strong><br>
      ‚úî ${entry.seance || "‚Äî"}<br>
      üìù ${entry.devoirs || "‚Äî"}<br>
      <button onclick="editData('${date}')">‚úèÔ∏è Modifier</button>
      <button onclick="deleteData('${date}')">üóëÔ∏è Supprimer</button>
    `;

    listDiv.appendChild(item);
  });
}

// Afficher les devoirs c√¥t√© √©l√®ve
function loadData(date) {
  let donnees = JSON.parse(localStorage.getItem("donnees")) || {};
  document.getElementById("seance").textContent = donnees[date]?.seance || "‚Äî";
  document.getElementById("devoirs").textContent = donnees[date]?.devoirs || "‚Äî";
}

// Quand l'√©l√®ve change de date
document.getElementById("date").addEventListener("change", function() {
  loadData(this.value);
});

// Charger les donn√©es initiales pour l'√©l√®ve
window.onload = function () {
  const dateInput = document.getElementById("date");
  if (dateInput.value) {
    loadData(dateInput.value);
  }
};
